name = "Handelnde \nPerson") +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text())
df_offender_summarized = full_data %>%
select(Q2.1, fem, male, other) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("weiblich" = rowSums(across(fem)),
"männlich" = rowSums(across(male)),
"keine Angabe" = rowSums(across(other)),
"gender_1" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("weiblich", "männlich", "keine Angabe") %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
melt() %>%
mutate(fraction = value/sum(value)) %>%
mutate(ymax = cumsum(fraction))
df = df_offender_summarized %>%
mutate(ymin = c(0, head(df_offender_summarized$ymax, n = -1)))
(p3 = ggplot(data = df, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=variable)) + theme_void() +
scale_y_continuous(name = "") +
scale_x_continuous(limits = c(1.5, 4)) +
scale_fill_manual(values = values_gender,
name = "Handelnde \nPerson") +
coord_polar(theta = "y") +
geom_rect(color = "white") +
theme(text = element_text(size = 15),
legend.position = "bottom",
legend.direction = "vertical"))
(p = plot_grid(p3, p2, p1, nrow = 1))
ggsave("reports/figures/P4.1.png", dpi = 700, width = 16)
p1 = ggplot() + theme_void() +
geom_bar(data = df_offender[df_offender$gender_1 %in% c("weiblich", "männlich"),], stat = "identity", position = "fill", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_y_continuous(breaks = c(0, 0.5, 1), labels = c("0 %", "50 %", "100 %")) +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(), axis.title.x = element_text())
p2 = ggplot() + theme_void() +
geom_bar(data = df_offender, stat = "identity", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text())
df_offender_summarized = full_data %>%
select(Q2.1, fem, male, other) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("weiblich" = rowSums(across(fem)),
"männlich" = rowSums(across(male)),
"keine Angabe" = rowSums(across(other)),
"gender_1" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("weiblich", "männlich", "keine Angabe") %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
melt() %>%
mutate(fraction = value/sum(value)) %>%
mutate(ymax = cumsum(fraction))
df = df_offender_summarized %>%
mutate(ymin = c(0, head(df_offender_summarized$ymax, n = -1)))
(p3 = ggplot(data = df, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=variable)) + theme_void() +
scale_y_continuous(name = "") +
scale_x_continuous(limits = c(1.5, 4)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
coord_polar(theta = "y") +
geom_rect(color = "white") +
theme(text = element_text(size = 15),
legend.position = "bottom",
legend.direction = "vertical"))
(p = plot_grid(p3, p2, p1, nrow = 1))
ggsave("reports/figures/P4.1.png", dpi = 700)
ggsave("reports/figures/P4.1.png", dpi = 700, width = 20)
save_plot("reports/figures/P4.1.png", dpi = 700, width = 20)
save_plot("reports/figures/P4.1.png", dpi = 700)
save_plot("reports/figures/P4.1.png", p, dpi = 700)
?save_plot
(p = plot_grid(p3, p2, p1, nrow = 1) +
theme(legend.box.margin = margin()))
ggsave("reports/figures/P4.1.png", dpi = 700)
ggsave("reports/figures/P4.1.png", dpi = 700, width = 15
ggsave("reports/figures/P4.1.png", dpi = 700, width = 15)
ggsave("reports/figures/P4.1.png", dpi = 700, width = 15)
ggsave("reports/figures/P4.1.png", dpi = 700, width = 25)
?legend.box.margin
p1 = ggplot() + theme_void() +
geom_bar(data = df_offender[df_offender$gender_1 %in% c("weiblich", "männlich"),], stat = "identity", position = "fill", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_y_continuous(breaks = c(0, 0.5, 1), labels = c("0 %", "50 %", "100 %")) +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -10))
p1
p2 = ggplot() + theme_void() +
geom_bar(data = df_offender, stat = "identity", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text())
df_offender_summarized = full_data %>%
select(Q2.1, fem, male, other) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("weiblich" = rowSums(across(fem)),
"männlich" = rowSums(across(male)),
"keine Angabe" = rowSums(across(other)),
"gender_1" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("weiblich", "männlich", "keine Angabe") %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
melt() %>%
mutate(fraction = value/sum(value)) %>%
mutate(ymax = cumsum(fraction))
df = df_offender_summarized %>%
mutate(ymin = c(0, head(df_offender_summarized$ymax, n = -1)))
(p3 = ggplot(data = df, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=variable)) + theme_void() +
scale_y_continuous(name = "") +
scale_x_continuous(limits = c(1.5, 4)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
coord_polar(theta = "y") +
geom_rect(color = "white") +
theme(text = element_text(size = 15),
legend.position = "bottom",
legend.direction = "vertical"))
(p = plot_grid(p3, p2, p1, nrow = 1))
ggsave("reports/figures/P4.1.png", dpi = 700, width = 14)
p2 = ggplot() + theme_void() +
geom_bar(data = df_offender, stat = "identity", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -10))
df_offender_summarized = full_data %>%
select(Q2.1, fem, male, other) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("weiblich" = rowSums(across(fem)),
"männlich" = rowSums(across(male)),
"keine Angabe" = rowSums(across(other)),
"gender_1" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("weiblich", "männlich", "keine Angabe") %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
melt() %>%
mutate(fraction = value/sum(value)) %>%
mutate(ymax = cumsum(fraction))
df = df_offender_summarized %>%
mutate(ymin = c(0, head(df_offender_summarized$ymax, n = -1)))
(p3 = ggplot(data = df, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=variable)) + theme_void() +
scale_y_continuous(name = "") +
scale_x_continuous(limits = c(1.5, 4)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
coord_polar(theta = "y") +
geom_rect(color = "white") +
theme(text = element_text(size = 15),
legend.position = "bottom",
legend.direction = "vertical"))
(p = plot_grid(p3, p2, p1, nrow = 1))
ggsave("reports/figures/P4.1.png", dpi = 700, width = 14)
ggsave("reports/figures/P4.1.png", dpi = 700, width = 30)
p1 = ggplot() + theme_void() +
geom_bar(data = df_offender[df_offender$gender_1 %in% c("weiblich", "männlich"),], stat = "identity", position = "fill", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_y_continuous(breaks = c(0, 0.5, 1), labels = c("0 %", "50 %", "100 %")) +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -10))
p2 = ggplot() + theme_void() +
geom_bar(data = df_offender, stat = "identity", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -10))
df_offender_summarized = full_data %>%
select(Q2.1, fem, male, other) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("weiblich" = rowSums(across(fem)),
"männlich" = rowSums(across(male)),
"keine Angabe" = rowSums(across(other)),
"gender_1" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("weiblich", "männlich", "keine Angabe") %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
melt() %>%
mutate(fraction = value/sum(value)) %>%
mutate(ymax = cumsum(fraction))
df = df_offender_summarized %>%
mutate(ymin = c(0, head(df_offender_summarized$ymax, n = -1)))
(p3 = ggplot(data = df, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=variable)) + theme_void() +
scale_y_continuous(name = "") +
scale_x_continuous(limits = c(1.5, 4)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
coord_polar(theta = "y") +
geom_rect(color = "white") +
theme(text = element_text(size = 15),
legend.position = "bottom",
legend.direction = "vertical"))
(p = plot_grid(p3, p2, p1, nrow = 1, rel_widths = c(0.8, 1, 1)))
ggsave("reports/figures/P4.1.png", dpi = 700, width = 14)
p2 = ggplot() + theme_void() +
geom_bar(data = df_offender, stat = "identity", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -30))
df_offender_summarized = full_data %>%
select(Q2.1, fem, male, other) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("weiblich" = rowSums(across(fem)),
"männlich" = rowSums(across(male)),
"keine Angabe" = rowSums(across(other)),
"gender_1" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("weiblich", "männlich", "keine Angabe") %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
melt() %>%
mutate(fraction = value/sum(value)) %>%
mutate(ymax = cumsum(fraction))
df = df_offender_summarized %>%
mutate(ymin = c(0, head(df_offender_summarized$ymax, n = -1)))
(p3 = ggplot(data = df, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=variable)) + theme_void() +
scale_y_continuous(name = "") +
scale_x_continuous(limits = c(1.5, 4)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
coord_polar(theta = "y") +
geom_rect(color = "white") +
theme(text = element_text(size = 15),
legend.position = "bottom",
legend.direction = "vertical"))
(p = plot_grid(p3, p2, p1, nrow = 1, rel_widths = c(0.8, 1, 1)))
ggsave("reports/figures/P4.1.png", dpi = 700, width = 14)
p2 = ggplot() + theme_void() +
geom_bar(data = df_offender, stat = "identity", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -50))
df_offender_summarized = full_data %>%
select(Q2.1, fem, male, other) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("weiblich" = rowSums(across(fem)),
"männlich" = rowSums(across(male)),
"keine Angabe" = rowSums(across(other)),
"gender_1" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("weiblich", "männlich", "keine Angabe") %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
melt() %>%
mutate(fraction = value/sum(value)) %>%
mutate(ymax = cumsum(fraction))
df = df_offender_summarized %>%
mutate(ymin = c(0, head(df_offender_summarized$ymax, n = -1)))
(p3 = ggplot(data = df, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=variable)) + theme_void() +
scale_y_continuous(name = "") +
scale_x_continuous(limits = c(1.5, 4)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
coord_polar(theta = "y") +
geom_rect(color = "white") +
theme(text = element_text(size = 15),
legend.position = "bottom",
legend.direction = "vertical"))
(p = plot_grid(p3, p2, p1, nrow = 1, rel_widths = c(0.8, 1, 1)))
ggsave("reports/figures/P4.1.png", dpi = 700, width = 14)
p1 = ggplot() + theme_void() +
geom_bar(data = df_offender[df_offender$gender_1 %in% c("weiblich", "männlich"),], stat = "identity", position = "fill", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_y_continuous(breaks = c(0, 0.5, 1), labels = c("0 %", "50 %", "100 %")) +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -10, r = 20))
p2 = ggplot() + theme_void() +
geom_bar(data = df_offender, stat = "identity", color = "white",
aes(x = gender_1, y = value, fill = variable)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -50))
df_offender_summarized = full_data %>%
select(Q2.1, fem, male, other) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("weiblich" = rowSums(across(fem)),
"männlich" = rowSums(across(male)),
"keine Angabe" = rowSums(across(other)),
"gender_1" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("weiblich", "männlich", "keine Angabe") %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
melt() %>%
mutate(fraction = value/sum(value)) %>%
mutate(ymax = cumsum(fraction))
df = df_offender_summarized %>%
mutate(ymin = c(0, head(df_offender_summarized$ymax, n = -1)))
(p3 = ggplot(data = df, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=variable)) + theme_void() +
scale_y_continuous(name = "") +
scale_x_continuous(limits = c(1.5, 4)) +
scale_fill_manual(values = values_gender,
name = "Handelnde Person") +
coord_polar(theta = "y") +
geom_rect(color = "white") +
theme(text = element_text(size = 15),
legend.position = "bottom",
legend.direction = "vertical"))
(p = plot_grid(p3, p2, p1, nrow = 1, rel_widths = c(0.8, 1, 1)))
ggsave("reports/figures/P4.1.png", dpi = 700, width = 14)
(p = plot_grid(p3, p2, p1, nrow = 1))
ggsave("reports/figures/P4.1.png", dpi = 700, width = 14)
#handelnde Person
main_question_q3 = c("Q3.1", "Q3.5", "Q3.9", "Q3.13", "Q3.17", "Q3.21", "Q3.25", "Q3.29",
"Q3.33", "Q3.37", "Q3.41", "Q3.45", "Q3.49", "Q3.53", "Q3.57")
main_question_q4 = c("Q4.1", "Q4.7", "Q4.13", "Q4.19", "Q4.25", "Q4.31", "Q4.37", "Q4.43",
"Q4.49", "Q4.55", "Q4.61", "Q4.67", "Q4.73", "Q4.79")
stud = c("Q3.2A1", "Q3.6A1", "Q3.10A1", "Q3.14A1", "Q3.18A1", "Q3.22A1",
"Q3.26A1", "Q3.30A1", "Q3.34A1", "Q3.38A1", "Q3.42A1", "Q3.46A1", "Q3.50A1", "Q3.54A1", "Q3.58A1")
doz = c("Q3.2A2", "Q3.6A2", "Q3.10A2", "Q3.14A2", "Q3.18A2", "Q3.22A2",
"Q3.26A2", "Q3.30A2", "Q3.34A2", "Q3.38A2", "Q3.42A2", "Q3.46A2", "Q3.50A2", "Q3.54A2", "Q3.58A2")
ang = c("Q3.2A3", "Q3.6A3", "Q3.10A3", "Q3.14A3", "Q3.18A3", "Q3.22A3",
"Q3.26A3", "Q3.30A3", "Q3.34A3", "Q3.38A3", "Q3.42A3", "Q3.46A3", "Q3.50A3", "Q3.54A3", "Q3.58A3")
df_offender = full_data %>%
select(Q2.1, stud, doz, ang) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("Mitstudierende*r" = rowSums(across(stud)),
"Dozierende*r" = rowSums(across(doz)),
"HTWG Angestellte*r" = rowSums(across(ang)),
"gender" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("gender", "Mitstudierende*r", "Dozierende*r", "HTWG Angestellte*r") %>%
melt(id.vars = "gender")
df_offender$variable = factor(df_offender$variable, levels = c("Mitstudierende*r", "Dozierende*r",  "HTWG Angestellte*r"))
df_offender$gender = factor(df_offender$gender, levels = codes_gender$gender)
p1 = ggplot() + theme_void() +
geom_bar(data = df_offender[df_offender$gender %in% c("weiblich", "männlich"),], stat = "identity", position = "fill", color = "white",
aes(x = gender, y = value, fill = variable)) +
scale_fill_manual(values = c("Mitstudierende*r" = dark_blue, "HTWG Angestellte*r" = soft_blue, "Dozierende*r" = teal),
name = "Handelnde Person") +
scale_y_continuous(breaks = c(0, 0.5, 1), labels = c("0 %", "50 %", "100 %")) +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -10, r = 20))
p2 = ggplot() + theme_void() +
geom_bar(data = df_offender, color = "white", stat = "identity",
aes(x = gender, y = value, fill = variable)) +
scale_fill_manual(values = c("Mitstudierende*r" = dark_blue, "HTWG Angestellte*r" = soft_blue, "Dozierende*r" = teal),
name = "Handelnde Person") +
scale_x_discrete(name = "Betroffene Person") +
theme(axis.text = element_text(),
axis.title.x = element_text(),
legend.box.margin = margin(l = -50))
df_offender_summarized = full_data %>%
select(Q2.1, stud, doz, ang) %>%
group_by(Q2.1) %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
filter(!is.na(Q2.1)) %>%
mutate("Mitstudierende*r" = rowSums(across(stud)),
"Dozierende*r" = rowSums(across(doz)),
"HTWG Angestellte*r" = rowSums(across(ang)),
"gender" = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
select("Mitstudierende*r", "Dozierende*r", "HTWG Angestellte*r") %>%
summarize(across(everything(), ~ sum(.x, na.rm = TRUE))) %>%
melt() %>%
mutate(fraction = value/sum(value)) %>%
mutate(ymax = cumsum(fraction))
df = df_offender_summarized %>%
mutate(ymin = c(0, head(df_offender_summarized$ymax, n = -1)))
(p3 = ggplot(data = df, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=variable)) + theme_void() +
scale_y_continuous(name = "") +
scale_x_continuous(limits = c(1.5, 4)) +
scale_fill_manual(values = c("Mitstudierende*r" = dark_blue, "HTWG Angestellte*r" = soft_blue, "Dozierende*r" = teal),
name = "Handelnde Person") +
coord_polar(theta = "y") +
geom_rect( color = "white") +
theme(text = element_text(size = 15),
legend.position = "bottom",
legend.direction = "vertical"))
(p = plot_grid(p3, p2, p1, nrow = 1))
ggsave("reports/figures/P4.2.png", dpi = 700, width = 15)
df_faculty_incident = full_data %>%
select(Q2.2, Q2.1, main_question_q3) %>%
filter(!is.na(Q2.2)) %>%
mutate(faculty = codes_faculty$faculty[match(Q2.2, codes_faculty$code)],
gender = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
filter_at(vars(main_question_q3), any_vars (. == 1)) %>%
select(-Q2.2, -Q2.1) %>%
melt(id.vars = c("gender", "faculty")) %>%
filter(value == 1) %>%
count(faculty, gender)
p1 = ggplot() + theme_void() +
geom_bar(data = df_faculty_incident, stat = "identity", color = "white",
aes(x = faculty, y = n, fill = gender)) +
coord_flip() +
scale_fill_manual(values = values_gender,
name = "") +
scale_y_continuous(name = "Anzahl der Vorfälle") +
theme(axis.text = element_text(hjust = 1),
axis.title.x = element_text())
df_faculty_affected = full_data %>%
select(Q2.2, Q2.1, main_question_q3) %>%
filter(!is.na(Q2.2),
!is.na(Q2.1)) %>%
mutate(faculty = codes_faculty$faculty[match(Q2.2, codes_faculty$code)],
gender = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
filter_at(vars(main_question_q3), any_vars (. == 1)) %>%
select(-Q2.2, -Q2.1) %>%
count(faculty, gender)
df_faculty_all = full_data %>%
select(Q2.2, Q2.1) %>%
filter(!is.na(Q2.2),
!is.na(Q2.1)) %>%
mutate(faculty = codes_faculty$faculty[match(Q2.2, codes_faculty$code)],
gender = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
count(faculty, gender) %>%
rename(n_all = n) %>%
left_join(df_faculty_affected) %>%
mutate(share = n/n_all) %>%
filter(gender %in% c("männlich", "weiblich"),
faculty != "keine Angabe")
df_faculty_all = full_data %>%
select(Q2.2, Q2.1) %>%
filter(!is.na(Q2.2),
!is.na(Q2.1)) %>%
mutate(faculty = codes_faculty$faculty[match(Q2.2, codes_faculty$code)],
gender = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
count(faculty, gender) %>%
rename(n_all = n) %>%
left_join(df_faculty_affected) %>%
mutate(share = n/n_all) %>%
filter(gender %in% c("männlich", "weiblich"),
faculty != "keine Angabe") +
theme(,
legend.box.margin = margin(l = -10, r = 20))
p1 = ggplot() + theme_void() +
geom_bar(data = df_faculty_incident, stat = "identity", color = "white",
aes(x = faculty, y = n, fill = gender)) +
coord_flip() +
scale_fill_manual(values = values_gender,
name = "") +
scale_y_continuous(name = "Anzahl der Vorfälle") +
theme(axis.text = element_text(hjust = 1),
axis.title.x = element_text(),
legend.box.margin = margin(l = -10, r = 20))
df_faculty_affected = full_data %>%
select(Q2.2, Q2.1, main_question_q3) %>%
filter(!is.na(Q2.2),
!is.na(Q2.1)) %>%
mutate(faculty = codes_faculty$faculty[match(Q2.2, codes_faculty$code)],
gender = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
filter_at(vars(main_question_q3), any_vars (. == 1)) %>%
select(-Q2.2, -Q2.1) %>%
count(faculty, gender)
df_faculty_all = full_data %>%
select(Q2.2, Q2.1) %>%
filter(!is.na(Q2.2),
!is.na(Q2.1)) %>%
mutate(faculty = codes_faculty$faculty[match(Q2.2, codes_faculty$code)],
gender = codes_gender$gender[match(Q2.1, codes_gender$code)]) %>%
count(faculty, gender) %>%
rename(n_all = n) %>%
left_join(df_faculty_affected) %>%
mutate(share = n/n_all) %>%
filter(gender %in% c("männlich", "weiblich"),
faculty != "keine Angabe")
p2 = ggplot() + theme_void() +
geom_bar(data = df_faculty_all, stat = "identity", position = "dodge", color = "white",
aes(x = faculty, y = share, fill = gender)) +
coord_flip() +
scale_fill_manual(values = values_gender,
name = "") +
scale_y_continuous(breaks = c(0, 0.25, 0.5), labels = c("0 %", "25 %", "50 %"), name = "Betroffene in % der Befragten") +
theme(axis.text = element_text(hjust = 1),
axis.title.x = element_text(),
legend.box.margin = margin(l = -10, r = 20))
(p = plot_grid(p1, p2, nrow = 2))
ggsave("reports/figures/P5.1.png", dpi = 700)
